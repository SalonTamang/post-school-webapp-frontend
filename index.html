<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coursework1 | Web Development with Vue.js</title>
    <!-- adding bootstrap for design -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- adding vue.js script to page -->
    <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>
    <!-- adding font awesome for icons -->
    <script src="https://kit.fontawesome.com/c8521bd5d1.js" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="style.css">

</head>
<body>
    <div id="app">
        <nav class="toolbar-container">
            <center><h1 style="font-size: 2rem;" v-text="sitename"></h1></center>
            <!-- search bar -->
            <div>
                <label for="search">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.75 15.75L12.3855 12.3795L15.75 15.75ZM14.25 7.875C14.25 9.56576 13.5784 11.1873 12.3828 12.3828C11.1873 13.5784 9.56576 14.25 7.875 14.25C6.18424 14.25 4.56274 13.5784 3.36719 12.3828C2.17165 11.1873 1.5 9.56576 1.5 7.875C1.5 6.18424 2.17165 4.56274 3.36719 3.36719C4.56274 2.17165 6.18424 1.5 7.875 1.5C9.56576 1.5 11.1873 2.17165 12.3828 3.36719C13.5784 4.56274 14.25 6.18424 14.25 7.875V7.875Z" stroke="#00577C" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <input class="bg-white rounded border-0 p-2" type="search" v-model="searchQuery" placeholder="Search lessons" v-on:input="searchProducts(searchQuery)">
                </label>
            </div>
            <!-- checkbutton -->
            <div id="checkOutContainer">
                <button v-on:click="showCheckout" v-if="showCheckoutButton" class="btn">
                    <!-- 'cartItemCount' is used the same way as a data property. -->
                    {{ cartItemCount }}
                    <!-- add the cart icon -->
                    <span class="fas fa-cart-plus"></span> Checkout
                </button>
                <button v-else disabled>
                {{ cartItemCount }}
                    <!-- add the cart icon -->
                    <span class="fas fa-cart-plus"></span> Checkout
                </button>
            </div>
        </nav>

        
        <section class="mainContainer">
            <div class="sortContainer flex-shrink-1 p-4">
                <!-- Sorting -->
                <b>Sort By</b>
                <hr>
                <span class="btn" v-on:click="filterSelection('title')"> Title</span>
                <span class="btn" v-on:click="filterSelection('location')"> Location</span>
                <span class="btn" v-on:click="filterSelection('price')"> Price</span>
                <span class="btn" v-on:click="filterSelection('availability')"> Availability</span>
                <br>
                <b>Order by</b>
                <hr>
                <span class="btn" v-on:click="sortSelection('asc')"> Ascending <i class="fa-solid fa-arrow-up"></i></span>
                <span class="btn" v-on:click="sortSelection('desc')"> Descending <i class="fa-solid fa-arrow-down"></i></span> 
            </div>
            <!-- Main page view -->
            <div class="lessonsContainer" v-if="showProduct">
                <div class="product" v-for="product in products">
                    <div class="mb-3 justify-content-center">
                        <div class="w-100 rounded bg-white col-md-10 p-3">
                            <div class="w-100 d-flex justify-content-between col-md-6">
                                <div class="images">
                                    <div class="text-center p-2"> <img id="main-image" style="object-fit: contain;" v-bind:src="product.image" height="300" width="250"/> </div>
                                </div>
                        
                                <div class="p-1">
                                    <div class="mb-3">
                                        <h5 class="text-uppercase" v-html="product.title"></h5>
                                        <div class="d-flex flex-row align-items-center"> <p><b><span class="act-price">${{product.price}}</span></b><span style="font-size: 13px;"> [{{product.available}} spaces]</span></p></div>
                                    </div>
                                    <p v-text="product.location"></p>
                                    <!-- add to cart button -->
                                    <div class="mt-4 align-items-center">
                                        <button v-on:click="addToCart(product)" v-if="canAddToCart(product)" class="btn btn-danger text-uppercase mr-1 px-2">Add to cart</button>
                                        <!-- This button will be displayed otherwise -->
                                        <span v-if="product.available >= 2">
                                            Buy now!
                                        </span>
                                        <span v-else-if="product.available === 1" class="red">
                                            Only 1 space left!
                                        </span>
                                        <div v-else>
                                            <button class="btn btn-danger text-uppercase mr-1 px-2" disabled>Add to cart</button>
                                            <span>No more spaces </span>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div v-else>


            </div>
            <!-- checkout page -->
            <!-- remove from cart button -->
            <!-- <button class="btn btn-secondary" @click="removeFromCart(product)" v-show="showRemoveButton">Remove from cart</button> -->
        </section>
    </div>
    <!-- vue.js script for application -->
    <script type="text/javascript">
        var webstore = new Vue({
            el:"#app",
            data:{
                showProduct:true,
                sitename:"After School",
                products: [
                    {
                        id: 1,
                        title: "<b>Maths</b>",
                        location: "India",
                        price: 100,
                        image: "images/Math.jpg",
                        available:10
                    },
                    {
                        id: 2,
                        title: "<b>English</b>",
                        location: "Oxford",
                        price: 30,
                        image: "images/english.jpg",
                        available:7
                    },
                    {
                        id: 3,
                        title: "<b>Science</b>",
                        location: "Nepal",
                        price: 15,
                        image: "images/science.jpg",
                        available:15
                    },
                    {
                        id: 4,
                        title: "<b>Sports</b>",
                        location: "Spain",
                        price: 45,
                        image: "images/sport.jpg",
                        available:17
                    },
                    {
                        id: 5,
                        title: "<b>Music</b>",
                        location: "London",
                        price: 53.99,
                        image: "images/music.jpg",
                        available:5
                    },
                    {
                        id: 6,
                        title: "<b>Art</b>",
                        location: "China",
                        price: 35,
                        image: "images/art.jpg",
                        available:7
                    },
                    {
                        id: 7,
                        title: "<b>Fashion</b>",
                        location: "Geda",
                        price: 59,
                        image: "images/fashion.jpg",
                        available:10
                    },
                    {
                        id: 8,
                        title: "<b>Hair cutting</b>",
                        location: "China",
                        price: 95,
                        image: "images/hair.jpg",
                        available:9
                    },
                    {
                        id: 9,
                        title: "<b>Dance</b>",
                        location: "Canada",
                        price: 75,
                        image: "images/dance.jpg",
                        available:7
                    },
                    {
                        id: 10,
                        title: "<b>Drawing</b>",
                        location: "Polland",
                        price: 65,
                        image: "images/drawing.jpg",
                        available:8
                    },
                    {
                        id: 11,
                        title: "<b>Construction</b>",
                        location: "Hetauda",
                        price: 55,
                        image: "images/construction.jpg",
                        available:14
                    },
                    {
                        id: 12,
                        title: "<b>Health</b>",
                        location: "USA",
                        price: 105,
                        image: "images/health.jpg",
                        available:20
                    },
                ],
                cart : [],
                searchQuery: '',
                sortedProducts:[],
                sortBy:'default',
                name:'',
                phone:'',
            },
            methods:{
                addToCart: function(product){
                    this.cart.push(product.id);
                    product.available--;
                },
                showCheckout() {
                    this.showProduct = this.showProduct ? false : true;
                },
                removeFromCart(product){
                    this.cart.splice(0);
                    product.available++;
                },
                cartCount (id) {
                    let count = 0
                    for (let i = 0; i < this.cart.length; i++) {
                        if (this.cart[i] === id) {
                            count++
                        }
                    }
                    return count
                },
                canAddToCart(product) {
                    return product.available > 0;
                }
            },
            computed:{
                cartItemCount: function(){
                    return this.cart.length || "0";
                },
                showCheckoutButton: function(){
                    return this.cart.length > 0;
                },
                showRemoveButton: function(){
                    return this.cart.length != 0;
                }               
            }
        });
    </script>
</body>
</html>